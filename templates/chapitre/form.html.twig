{% extends 'back_base.html.twig' %}

{% block title %}{{ edit ? 'Modifier Chapitre' : 'Ajouter Chapitre' }} | BacLab Admin{% endblock %}

{% block body %}
<style>
    /* === DESIGN SYSTEM (Identique à Matière pour la cohérence) === */
    :root {
        --primary: #f59e0b; /* Orange pour différencier les chapitres */
        --primary-dark: #d97706;
        --primary-light: #fbbf24;
        --success: #10b981;
        --danger: #ef4444;
        --gray-50: #f9fafb;
        --gray-200: #e5e7eb;
        --gray-400: #9ca3af;
        --gray-700: #374151;
        --radius-lg: 1rem;
        --radius-xl: 1.5rem;
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        --transition: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .form-page {
        min-height: 100vh;
        background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem 1rem;
        position: relative;
    }

    .form-container { width: 100%; max-width: 600px; z-index: 1; }

    .form-card {
        background: white;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-xl);
        overflow: hidden;
        animation: slideUp 0.6s ease-out;
    }

    @keyframes slideUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .form-header {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        padding: 2.5rem 2rem;
        text-align: center;
        color: white;
    }

    .form-icon {
        width: 60px; height: 60px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: var(--radius-lg);
        display: flex; align-items: center; justify-content: center;
        margin: 0 auto 1rem; font-size: 1.5rem;
        border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .form-body { padding: 2rem; }

    .form-group { margin-bottom: 1.5rem; position: relative; }

    .form-label {
        display: block; font-size: 0.875rem; font-weight: 600;
        color: var(--gray-700); margin-bottom: 0.5rem;
    }

    .input-wrapper { position: relative; }

    .input-icon {
        position: absolute; left: 1rem; top: 50%;
        transform: translateY(-50%); color: var(--gray-400);
        pointer-events: none; transition: var(--transition);
    }

    /* Ajustement pour l'icône dans le champ Contenu (Textarea) */
    .textarea-wrapper .input-icon { top: 1.2rem; transform: none; }

    .form-control-custom {
        width: 100%;
        padding: 0.875rem 1rem 0.875rem 2.75rem;
        background: var(--gray-50);
        border: 2px solid var(--gray-200);
        border-radius: var(--radius-lg);
        transition: var(--transition);
        font-family: inherit;
    }

    .form-control-custom:focus {
        outline: none; border-color: var(--primary);
        background: white; box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.1);
    }

    /* Actions */
    .btn-group { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 2rem; }
    
    .btn-primary-custom {
        padding: 1rem; background: var(--primary); color: white;
        border: none; border-radius: var(--radius-lg); font-weight: 600;
        cursor: pointer; transition: var(--transition);
        display: flex; align-items: center; justify-content: center; gap: 0.5rem;
    }

    .btn-primary-custom:hover { background: var(--primary-dark); transform: translateY(-2px); }

    .btn-secondary-custom {
        padding: 0.875rem; text-align: center; color: var(--gray-700);
        text-decoration: none; border: 2px solid var(--gray-200);
        border-radius: var(--radius-lg); font-weight: 600;
    }

    .error-message { color: var(--danger); font-size: 0.8rem; margin-top: 0.4rem; }
</style>

<div class="form-page">
    <div class="form-container">
        <div class="form-card">
            <div class="form-header">
                <div class="form-icon">
                    <i class="fas {{ edit ? 'fa-file-signature' : 'fa-plus-circle' }}"></i>
                </div>
                <h1 style="font-size: 1.5rem; margin: 0;">{{ edit ? 'Modifier le Chapitre' : 'Nouveau Chapitre' }}</h1>
                <p style="opacity: 0.8; font-size: 0.9rem; margin-top: 0.5rem;">Configurez les détails du chapitre pédagogique</p>
            </div>

            <div class="form-body">
                {{ form_start(form, {'attr': {'id': 'chapitre-form'}}) }}

                {# Titre #}
                <div class="form-group">
                    <label class="form-label">Titre du chapitre</label>
                    <div class="input-wrapper">
                        <i class="fas fa-heading input-icon"></i>
                        {{ form_widget(form.titre, {
                            'attr': {'class': 'form-control-custom', 'placeholder': 'Ex: Calcul intégral'}
                        }) }}
                    </div>
                    {{ form_errors(form.titre) }}
                </div>

                {# Matière et Ordre sur la même ligne #}
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Matière associée</label>
                        <div class="input-wrapper">
                            <i class="fas fa-book input-icon"></i>
                            {{ form_widget(form.matiere, {
                                'attr': {'class': 'form-control-custom'}
                            }) }}
                        </div>
                        {{ form_errors(form.matiere) }}
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ordre (Position)</label>
                        <div class="input-wrapper">
                            <i class="fas fa-sort-numeric-down input-icon"></i>
                            {{ form_widget(form.ordre, {
                                'attr': {'class': 'form-control-custom', 'placeholder': 'Ex: 1'}
                            }) }}
                        </div>
                        {{ form_errors(form.ordre) }}
                    </div>
                </div>

                {# Contenu #}
                <div class="form-group">
                    <label class="form-label">Contenu / Description</label>
                    <div class="input-wrapper textarea-wrapper">
                        <i class="fas fa-align-left input-icon"></i>
                        {{ form_widget(form.contenu, {
                            'attr': {
                                'class': 'form-control-custom', 
                                'style': 'height: 150px; resize: vertical;', 
                                'placeholder': 'Entrez le contenu du chapitre...'
                            }
                        }) }}
                    </div>
                    {{ form_errors(form.contenu) }}
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn-primary-custom">
                        <i class="fas {{ edit ? 'fa-save' : 'fa-plus' }}"></i>
                        {{ edit ? 'Enregistrer les modifications' : 'Créer le chapitre' }}
                    </button>
                    
                    <a href="{{ path('chapitre_index') }}" class="btn-secondary-custom">
                        Annuler
                    </a>
                </div>

                {{ form_end(form) }}
            </div>
        </div>
    </div>
</div>
{% endblock %}